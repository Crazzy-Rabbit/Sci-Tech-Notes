# 分子群体遗传笔记
> By **Evan** from 微信公众号“**AI写代码的DNA**” and **知乎**  
> > 资料来源：Molecular Population Genetics 1st Edition： by Matthew W. Hahn (Author)  
> 仅供个人学习参考，仅改变个别错漏之处和排版格式，版权为原作者所有

- [分子群体遗传笔记](#分子群体遗传笔记)
  - [（一）绪论](#一绪论)
    - [一、什么是分子群体遗传学](#一什么是分子群体遗传学)
    - [二、进化过程的模型](#二进化过程的模型)
      - [1、群体数量模型](#1群体数量模型)
      - [2、有效群体数量（effective population size)](#2有效群体数量effective-population-size)
      - [3、突变模型](#3突变模型)
      - [4、重组模型](#4重组模型)
      - [5、自然选择模型](#5自然选择模型)
      - [6、迁徙模型](#6迁徙模型)
      - [7、交配模型](#7交配模型)
  - [（二）分子进化理论](#二分子进化理论)
    - [一、中性理论](#一中性理论)
    - [二、关于中性理论的误解和误用](#二关于中性理论的误解和误用)
    - [三、其他分子进化模型](#三其他分子进化模型)
  - [（三）实验设计及测序](#三实验设计及测序)
    - [一、群体采样](#一群体采样)
    - [二、DNA测序](#二dna测序)
      - [短阅读片段的影响](#短阅读片段的影响)
      - [高错误率的影响](#高错误率的影响)
      - [针对二代测序的不同实验设计](#针对二代测序的不同实验设计)
    - [三、基因型](#三基因型)
  - [（四）变异的描述](#四变异的描述)
    - [一、在无限位点模型下SNP位点多样性估计θ](#一在无限位点模型下snp位点多样性估计θ)
    - [二、等位基因频谱](#二等位基因频谱)
    - [三、有限位点模型中序列多样性的测量](#三有限位点模型中序列多样性的测量)
    - [四、核酸多样性的解释](#四核酸多样性的解释)
    - [五、多样性的其他描述](#五多样性的其他描述)
  - [5](#5)


## （一）绪论
> https://zhuanlan.zhihu.com/p/360236713

### 一、什么是分子群体遗传学

分子群体遗传是生物领域最具有魅力的一个研究方向，融合了分子生物学和基因组学的先进技术和群体遗传学的理论与实践。在很多顶尖学术期刊上和各种学术会议上你都能够看到分子群体遗传的影子。

分子群体遗传学不同于遗传学的另外两个主要分支：**经典群体遗传学**和**定量遗传学**。经典群体遗传和定量遗传学主要关注对进化过程和对未来的进化预测。研究自然选择、遗传漂变、突变、迁徙等因素对基因频率和表型频率的研究。

而分子群体遗传学是研究“历史”的一个遗传学分支，它关注于是过去哪种进化驱动力导致了目前的遗传状况，通过对遗传分子数据的分析去**了解过去，而不在于对未来的预测**。这是因为这种特性，分子群体遗传学也被称为“**达尔文的侦探**”。

分子群体遗传主要关注于三个方面的问题：

- 第一，识别和某些性状相关的基因或突变。分子水平的变异有助于我们了解表型变化背后的驱动力。
- 第二，分子群体遗传可以使我们了解进化对整个基因组的影响。比如是什么因素维持了基因组某些区域变异的多样性，是否又与某些表型相关等。
- 第三，使用分子水平的变异来推测群体进化史。遗传分子能够告诉我们群体的迁徙、人口结构的变化，可以告诉我们过去的进化史。比如人类的走出非洲，可以通过分子水平的遗传变化得到佐证。

随着基因组测序技术的进步，如金钱和时间成本的降低，分子群体遗传研究的上述三个方面的问题正在快速融合：要想了解对某个基因的选择，我们必须比较自然选择在整个基因组水平的作用，要想了解选择在基因和基因组水平的作用，我们必须了解自然选择作用方式和作用效果的历史背景。

进化始于一个个体、一个染色体上的一个突变。分子群体遗传要研究自然种群中进化过程，这就需要通过研究群体中部分个体的DNA序列来弄清驱动整个群体进化的驱动力。这也是分子群体遗传常用的研究方法。通过基因位点的变异来推测突变、重组、自然选择以及群体数量在进化中的作用。

### 二、进化过程的模型

#### 1、群体数量模型

遗传漂变是由于群体数量有限而造成的基因频率的随机变化。在一个群体中，有些染色体会传递给下一代，而有些不会。

Wright-Fisher（W-F）模型是研究遗传漂变的经典模型。该模型假设群体数量为N，个体为二倍体，可以随机交配，子代与亲代没有世代重叠。某些一年生的植物或昆虫能够满足没有世代重叠，不过对脊椎动物，很难满足这个假设。但一般情况下，对假设没有那么严格的要求。

W-F模型的研究表明，在没有选择突变、没有选择压力的情况下，群体中平均等位基因的频率维持不变，基因频率的方差和群体数量有关系，群体数量越大，方差越小。虽然说总群体的等位基因频率维持不变，但是对于某个小群体，可能会出现该等位基因的丢失（基因频率 = 0）或者固定（基因频率 = 1）。这也就导致了该群体中基因变异性下降，同时群体中杂合子的数量也下降（2pq,当p = q = 0.5时，杂合子数量最多）。只有遗传漂变的情况下，杂合子下降速度为1/2N每代，也就是群体数量越大，杂合子下降速度越慢，对于一个小群体而言，遗传漂变会使群体子杂合子很快消失，而对于大群体，这是一个相当漫长的过程。

另一个模型是Moran模型，它不要求世代不能重叠，因而比W-F模型更实际一些。但严格意义上说，Moran模型只适用于单倍体。和W-F模型一样，Moran模型也显示在只有遗传漂变的情况下，平均等位基因的频率保持不变。但是，基因频率的方差却大了一倍，而杂合子在群体中下降的速度也快了1倍。

在实际使用中，由于W-F模型更加直观，所以使用也更加广泛。

#### 2、有效群体数量（effective population size)

在W-F模型中，假设群体数量为N，这N个个体都有均等的几率留下后代。但实际中，并不是这样的，由于选择压力的存在，会有小于N个个体留下后代。这里就涉及到一个有效群体数量（Ne)，它和实际的群体数量（“真”群体数量）不同，通常小于实际群体数量。更广义地讲，Ne并不是指个体数量，而是由W-F模型推定出来的，一个群体中，不同的基因组区域可能由不同的Ne。

关于Ne的概念确实是一个很抽象而且经常被误用的概念，有各种不同的定义方法。“有效”这个词的使用也通常会造成一些误解，与其说是“有效”，不如说“和W-F模型等效”。

#### 3、突变模型

因为突变有不同的形式，因而突变模型也有很多。不过这里我们强调的突变并不是生殖细胞中一个变异的出现过程，而是以一种定量的方式去描述一个若干代之前的突变怎样变成了现在的一个基因多样性位点，以及不同的突变速率怎样导致了不同数量的多样性位点。

在分子群体遗传中，常用到的是随机突变模型，假设所有的突变都是随机的。实际上，突变并不是那么随机，比如碱基转变的突变（嘌呤换嘌呤，嘧啶换嘧啶）比碱基转换的突变（嘌呤换嘧啶，嘧啶换嘌呤）要大的多，染色体不同区域的突变差异也很大，如突变率在CpG位点要比普通位点大10倍。当然，“随机”在进化上是说，一个突变的发生并不会因为其是有利突变还是有害突变而改变突变概率。由于突变概率非常低，通常每个碱基每代只有在10e-8到10e-9之间的突变概率，所以描述随机突变通常用Poisson模型。

在早起人们研究变异的时候，DNA测序还没能广泛使用，人们只能使用蛋白凝胶电泳的方法来判断是否存在变异，这也就导致了很多同义突变没能检测到。通过这种技术研究突变的模型称之为“无限等位基因模型”。所以这里的“等位基因”实际上是指不同的单倍体型，它可能包含很多个或者很多次的突变。而现在我们所说的等位基因通常是单个碱基变异。由于”无限等位基因“模型忽略掉了很多变异信息，所以在现代分子群体遗传学中很少使用。

#### 4、重组模型

和突变一样，重组的发生同样是小概率事件，可以用Poisson模型。重组在染色体上的发生并不是随机的，在染色体上存在很多“重组热点”，也就是很多重组事件发生的聚集区。当然，即便没有很明显的重组热点，染色体上重组的发生差异性也很大。重组的发生并不会改变群体中的基因频率，而单倍体型的频率会因此发生变化。

#### 5、自然选择模型

一个新的突变通常会带来三种效应：有利、有害和中性。

通常用s表示一个新突变的选择系数，也就是带有一个该突变基因和没有该突变基因个体的适应性差异。如果**s > 0，表示有利突变；s < 0，表示有害突变；s = 0，表示中性突变**。

对一个基因或位点的自然选择通常有3中：**负选择（negative selection), 正选择（postitive selection), 和平衡选择（balancing selection)**。

- 负选择：如果一个基因位点的突变大多数都是有害的，自然选择会淘汰掉这些突变。那么这种对该基因位点的选择称之为负选择。该位点为保守位点。大多数编码蛋白质的基因都经历着负选择，因为一个位点的改变可能导致该蛋白质发生变化，带来有害的生物学效果。
- 正选择：如果一个位点为有利突变，那么该突变的基因频率会增加或者在群体中得到固定。由于有利突变比有害突变要少的多，所以正选择并不多见。正选择发生时会在基因组中留下印迹，而寻找这些印迹，推断正选择已经成了分子群体遗传学中的研究热点。
- 平衡选择：维持一个位点在群体中的遗传多样性。不同于负选择和正选择，受到平衡选择位点的选择压力通常是随着时间、空间及种群基因频率而变化不定。如杂种优势、负向基因频率依赖的选择、依赖于时间和空间的选择等等都会造成一个位点的多样性长期维持，形成平衡选择。

#### 6、迁徙模型

种群不是固定在一个地方不变的，各个种群之间也会有迁徙。

迁徙率（m)，是指在一个群体中从其他群体中迁入个体的比例。这儿有两个假设，首先，迁入个体是其他群体中（源群体）的一个随机样本，也就是该迁入群体的基因频率和源群体的基因频率应该是一致的。第二，源群体和接受迁入群体的群体的数量不能因为迁入而改变。

下面是几种常用的迁徙模型：

![](https://pic4.zhimg.com/80/v2-9ba9e44ec474f8e9afd60a88c5fc7ae7_1440w.jpg)

#### 7、交配模型

最常使用的**Hardy-Weinberg**模型，它的假设是没有选择、没有突变、没有迁徙、没有遗传漂变、随机交配。

另外在实际中还有很对非随机交配情况，比如正相配交配和负相配交配。正相配交配是指具有相同形状的个体交配的几率更大（如身高高的更倾向于和身高高的个体交配）；负相配交配是指两种相反形状的个体交配的几率更大（如身高高的倾向于和身高矮的个体交配）。

正相配交配会显著增加群体内纯合子数量。一个极端的情况是近亲交配，会出现更多的纯合子。近亲交配系数，F，表示在基因组中，由于近亲交配而造成同一来源的等位基因所占的比例。F从0到1，F越大表示亲代近亲交配越严重。


## （二）分子进化理论
> https://zhuanlan.zhihu.com/p/360239291

### 一、中性理论

很少有关于分子变异模式的解释，直到60年代后期，才有Motoo Kimura和Jack King& Thamas Jukes提出一个叫做“**分子进化的中性理论**”。到80年代，Kimura进一步解释了中性理论:

绝大多数变异并不是达尔文的自然选择造成的，而是中性或者近乎中性地在群体中被随机固定下来。不同物种间分子水平的差异，如蛋白质的多态性，也是近乎中性的，而多态性的维持主要是靠随机突变的产生以及突变的固定或消亡。

这一中性理论强调了两点：

1. 物种间分子水平的差异主要是由于两个适应性差不多（中性）的等位基因的替换；
2. 物种内多态性基因的适应性差异很小，近乎中性，多态性的维持靠“突变-遗传漂变“平衡。

所以，中性理论认为种间差异和种内差异的本质是一样的，都是近乎中性的等位基因在群体中受到遗传漂变的作用而产生的随机固定和丢失。

中心理论能够很好的解释基因中不同位点或者基因组中不同基因的进化速度的不同。中心理论并没否定负向选择（负选择），实际上中性理论认为负向选择是决定不同分子进化速度的关键因素，而不是正向选择。Kimura提到了一个公式：

`u = vf`

其中`u`是中性突变，`v`是总突变，`f`是中性突变在总突变中所占的比例。在一个基因或者基因组中，总突变速度是一定的，但f是一个限制因素，决定了各个位点不同的中性突变速度。f越大，限制作用越小，会有更多的中性突变，进化速度越快。比如，在氨基酸密码子中，能够简并4个碱基的密码子位点比能够简并2个碱基的密码子位点的限制性要弱很多，因而f要大，所以能够简并4个碱基的密码子进化速度更快。通常我们会认为能够简并4碱基的位点的f=1,也就是该位点的全部突变均为中性突变。同样地，对与基因也是如此，如果某个基因具有很重要的功能，突变可能会受到严格的负向选择，那么该基因f会很小，相对会有更少的中性突变。

中性理论的另一个用途是能够很好的解释不同种群或者物种间核酸多态性水平的差异。如果在物种内一个位点的等位基因都是中性的，那么它的多态性水平仅仅受到中性突变和遗传漂变的影响。一个大的种群受遗传漂变的影响更小，而突变更多，因而大种群多态性要更高，反之，小种群中很多突变受到遗传漂变影响很大，要么固定（基因频率=1）要么丢失（基因频率=0），所以小种群多态性要小。

![](https://pic2.zhimg.com/80/v2-a175619bbb47e7b91e327241df06e705_1440w.jpg)

当然，中心理论也有很多局限性。对于基因组水平来说，大部分突变都发生在非编码区或者非功能区，都是中性的，中性理论能够很好的适用；但是对于发生在编码区或者功能区的突变来说，中性理论并不十分适合，很多因素影响到突变-遗传漂变的平衡。

### 二、关于中性理论的误解和误用

“中性”并不意味着没有选择。“中性”最早源于定量遗传学中，研究人员在说明突变和遗传漂变对表型进化的作用时，将“选择中性”混用为“没有选择”。

另一个容易弄混的地方是“中性突变”和“中性位点”。实际上只有中性突变，而不能说中性位点。对于位点，只能说位点没有受到选择的作用。关于中性突变和中性位点还有一下常见的错误理解：

1. 认为只有未被限制的位点才有中性突变。实际上所有的位点都会有中性突变，只是中性突变多少的差异，受限制位点的中性突变少。
2. 认为不受限制的位点也不会受到选择的影响。实际上不受选择的位点通常会和受选择位点有关联，也就是连锁不平衡，造成不受选择位点表现出“非中性”。
3. 认为受到限制的基因或者位点总是“非中性的”。一个中性进化的位点并不意味着没有选择，可能会有负向选择，但不会有其他形式的选择（正向选择、平衡选择等）。

### 三、其他分子进化模型

除了上述中性理论之外，还有其他一些关于分子进化的理论，但是其中很多都认为多态性和突变不是中性的，这显然是错误的。有三种典型的代表，其一是有害突变模型理论，认为所有的突变都是有害的，群体中的基因多态性主要是靠“突变-选择平衡”维持，而且多态性主要表现为过多的低频变异；第二个是有利突变理论，即突变都是有利的，群体中的基因多态性主要表现为突变固定过程中形成的等位基因，而且主要表现为过多的高频变异；第三个是平衡突变理论，群体中的基因多态性主要表现为中等频率的变异。这三种理论都存在很大的缺陷。

还有另外两种理论涉及基因关联性在选择中的作用，这两种理论能够很好的解释当前的观测数据情况。第一个是**背景选择模型**(background selection model)，认为群体中的负向选择在剔除有害变异的同时，也会影响该变异附近的一些位点的多态性，造成附近位点多态性降低。这一理论没有否定大多数突变是中性的，这和有害突变模型理论是不同的。另一种是**“搭便车”模型**(hitchhiking model),认为有利的变异在迅速的固定过程中，会降低其附近位点的多态性，同样的，这一理论也没有否定大多数突变是中性突变。几乎可以肯定地说，这两种理论做描述的现象在生物群体中是同时存在的，只是我们还不能确定在不同基因组和不同物种之间，哪一种现象更为普遍。

最后，还有一个理论值得提一下，就是“近乎中性理论”(nearly neutral theory of molecular evolution)，它是对中性理论的补充，认为大多数突变是轻度有害（或者轻度有利的），用来解释氨基酸替换率的问题。


## （三）实验设计及测序
> https://zhuanlan.zhihu.com/p/360240631

要想研究进化过程，需要从一个群体中随机抽取一定量的个体进行测序。那么需要多少样本量？怎样做到随机？如何得到精确的序列数据？这都是在实验设计中需要仔细考虑的问题。

### 一、群体采样

分子群体遗传中经常用的样本量在10-50个染色体组（或者5-25个二倍体个体）。当然不同的研究目的，样本量的需求也不一样，比如如果我们只关注多态性位点数量，那么很少的样本量就够了，但是如果我们关注群体中的基因频率，那么需要的样本量会超过50个。

样本的采集也要尽量避免有遗传关系的个体，如直系或旁系关系的个体等。同时我们的采样还要来自一个单一个群体，也就是群体中的个体都可以自由交配。目前很多遗传数据分析方法都是基于单一群体的假设，所以从10个群体中每个抽取1个个体和从1个群体中抽取10个个体会有很大的差异。

### 二、DNA测序

根据不同的研究目的，确定不同的测序策略，比如哪些位点需要测序，是测一个位点还是多个位点，或者是全基因组测序。

测序方法：

1. Sanger法：略
2. 二代测序：能够高通量便宜快速的获得全基因组数据。二代测序需要参考基因组进行后期比对。二代测序有两个特点，一是短阅读片段，二是高出错率。当然随着技术的改进，二代测序的读长也在增加，错误率在降低。

二代测序是同时进行数百万的片段序列测定，这些片段是在随机选择的（shotgun sequencing），这也就造成了各个位点的测序深度不同。有些位点被测过好多次，有些位点几乎没有被测到，造成整个染色体的测序质量差异很大，而且我们不能从测序样本中得到基因型。

![](https://pic3.zhimg.com/80/v2-3b7e5f73b4354b075aae7f8be73e670a_1440w.jpg)

在实际中，有很多因素影响测序深度，比如模版序列的GC含量、DNA提取方法等。

#### 短阅读片段的影响

二代测序的读长通常在35-600个碱基，分为单端测序(single-end)和双端测序(paired-end)。双端测序就是来自同一条DNA的两个等长的测序片段从两端分别测序。双端测序能够发现拷贝数变异以及其他基因组的结构变异。测序完之后就是要把测序片段和参考基因组比对，常用的软件有BWA, Bowtie,SOAP和Stampy。

通过二代测序可以很可靠地发现测序样本和参考基因组的差异，来判断一个位点是不同类型的纯合子还是杂合子。如下图,黑框标出的是和参考基因组不同的纯合子型，其他字母为测序错误：

![](https://pic1.zhimg.com/80/v2-6e4b04da5c70d3d368b318be38cf20dc_1440w.jpg)

二代测序非常依靠参考基因组。参考基因组的来源有很多不同的方式，有些是单系自交来源的个体，有的是杂交个体等等。不管哪种来源，都要求样本能够提供足够高质量的DNA。所有的参考基因组都是在数据库中以单倍体形式呈现的，也就是参考基因组的多态性位点也有整合成一种状态。所以我们实际上使用的参考基因组也仅仅是一种单倍体样本，如果我们自己测序样本有比较大的变异（我们样本序列的插入或者参考基因组序列的删除），就无法比对到参考基因组上，造成整个序列测序深度偏倚很大。有时候一个测序读长可以比对到基因组的很多地方，这个时候就引入了一个比对质量评分(mapping quality score)的指标对每一个测序读长进行评价。一个读长能够在参考基因组中比对的地方越多，它的评分就越低。对于读长较短的测序而言，基因组的重复序列给基因组比对带来了极大的困难。

#### 高错误率的影响

第二代测序的出错率要比Sanger测序高，虽然正在降低出错率，但每个碱基仍有0.3%的错误率。所以在只有一个读长覆盖的基因区域的序列，有很大可能会出现错误。不过测序错误也有一定的规律可寻，比如在每个阅读片段末端出现错误的概率要比起始端大。

同样的，为了评价每一个碱基的质量，引入了碱基质量评分(base quality score),表示出现碱基错误的概率。还有另一个综合性的评分(consensus quality score)，它通常会考虑碱基质量评分指标、比对质量评分指标以及附近的碱基质量评分。在二代测序中通常使用SAMtools和GATK工具来判断SNP位点。

#### 针对二代测序的不同实验设计

从上面的分析中可以看出，测序深度越高，越能够得到准确的DNA序列。那么到底需要多大测序深度？

这个问题要根据具体情况分析，比如**测序样本的杂合子多少**，**测序群体和参考基因组的遗传距离**，基因组中**重复序列的多少**等。可以通过Lander-Waterman模型来估计所需测序深度。一般而言，对于一个重复序列很少的自交系种群，10X的单端Illumina测序深度就足够了；对于人类个体而言，则需要30X双端测序。

为了获得准确的基因型，通常测序深度会很高(下图A），所以当有很多个个体需要测序的时候就会带来很大的工作量和花费。很多研究会使用测序深度较低的全基因组测序，虽然它不能保证每个个体的基因型都能被准确的测出，会错失掉很多低频等位基因，但是确实能够很快的发现大量的多态性位点（下图B）。还有一些研究使用部分基因组的高深度测序来代替全基因组测序，可以用来研究感兴趣的基因组区域变异情况。比如使用探针对外显子序列进行测序（下图C）。还有一些研究使用DNA限制位点测序(restriction-associated DNA sequencing, RAD),对特异性内切酶位点区域进行测序。通常在一个基因组中，只有数百到数千个位点可以进行切（下图D）。最后一种常用的方法是pool-seq,就是将很多个个体放在一起测序，这种方法不能够得到某个个体的基因型，但是能够很精确的得到群体中基因频率（下图E）。Pool-seq测序是根据阅读片段来获得基因频率的，所以对于一个测序来说，有足够多的染色体远比测序深度要重要，也就是样本量要大。使用Pool-seq还可以用来检测基因组中的转移元件和拷贝数变异。

![](https://pic4.zhimg.com/80/v2-3ae903648b991b737fd335faa2a9305f_1440w.jpg)

### 三、基因型

由阴性错误导致的基因型错判或者偏倚远比阳性错误造成的问题要大。如果参考基因组的碱基正好是祖系状态，那么阴性错误会严重低估等位基因频率。这也是为什么在数据处理中，宁愿将不可靠的碱基判定为缺失数据也不会轻易将其判定为阴性。


## （四）变异的描述
> https://zhuanlan.zhihu.com/p/360241563

针对不同类型的变异，有不同的统计量来描述变异。

在分子遗传学中常用到统计量**θ (=4Neμ)**,来描述在没有选择的（仅有变异-遗传漂变平衡）的情况下常染色体的变异数量。有很多数学方法可以计算得到θ，比如极大似然估计和贝叶斯方法等。但是这些方法对数据量有限制，不能将整个基因组数据一起分析，同时它们对缺失数据的处理也存在问题。

### 一、在无限位点模型下SNP位点多样性估计θ

表示一个位点的杂合性，通常用下面公式计算：

![](https://pic4.zhimg.com/80/v2-8765c2e076332362f3a2efcc9f45835f_1440w.jpg)

其中，n表示样本数量，Pi表示一个位点不同等位基因的频率。而如果我们要计算整个染色体或者序列片段的多样性呢，可以通过下面的计算公式完成：

![](https://pic1.zhimg.com/80/v2-f9b21f7c97deca67b5171927f2d868c4_1440w.jpg)

其中S是所有多态性位点的数量，h即第一个公式中的每一个位点的杂合性。对于满足Wright-Fisher平衡二倍体群体而言，π的期望值E(π) = θ。举例下图

![](https://pic4.zhimg.com/80/v2-cc28a38635f05f4cfee4a7919cd74a9f_1440w.jpg)

如计算该片段的多态性，我们可以应用第一个公式分别计算每一个位点的杂合性（0.5，0.667，0.5，0.667和0.5），然后将其相加即 π = 3.33

还有另外一种计算形式：

![](https://pic4.zhimg.com/80/v2-6dc65be0941451788aad1842e5972b37_1440w.jpg)

其中Kij是群体中序列两两比较时碱基不同位点的数量，n是样本数量。利用该公式计算的 π = 3.33，和第一种方法一样。但是如果序列的数量很多，第一种方法要比第二种方法简便一些。

不过当序列中有插入或者缺失时，两种方法的计算结果却不一样。比如下面一个例子：

![](https://pic1.zhimg.com/80/v2-d9bf7c647963e44dcdd4ceea8079c4a4_1440w.jpg)

用第一种方法得到 π = 3.49，第二种方法得到 π = 2.83（排除了1，2，9，10这四个缺失位点），在第一种计算方法中使用了全部15个位点，第二种方法中，只有11个位点。**所以当基因组中有很多缺失位点时，第一种计算方法要比第二种方法更好**！

关于 π 的方差，在没有基因重组的情况下，可以用下面的公式表示：

![](https://pic2.zhimg.com/80/v2-33f8db607391616c9edd9e85d95b66b5_1440w.jpg)

可以看出 π 的变异性与很多因素有关，即便样本量足够大，方差也不会为0。

另一种描述序列多样性的方法来自Watterson，公式如下：

![](https://pic1.zhimg.com/80/v2-d9bb408b1cede03cf42896c8373e0f94_1440w.jpg)

其中S表示多态性位点的数量。这也就是著名的**Watterson's theta**.

### 二、等位基因频谱

前面我们用π和θ来描述序列多样性，等位基因频谱同样可以描述。假设有如下图（A）一个基因序列，10条染色体，9个分离位点。针对每一个分离位点，如果我们不知道哪一个碱基是祖系状态，哪一个是后天得到的，那么这个时候 我们可以用**minor allele frequency(MAF)**来描述，也就是“少数等位基因”频率。MAF的范围在1/n - 0.5之间，用条形图表示出来就是下图（B）。它也被称为**site frequency spectrum(SFS)**。因为不能确定祖系状态，只能在“少数等位基因”，因而也被称为folded spectrum.

如果我们通过其他物种的基因组推测出了每一个位点的祖系状态，这个时候就可以用**derived allele frequency(DAF)**来表示位点变异情况，DAF的范围在1/n 到 (n-1)/n之间，相对应的，也被称为unfolded spectrum，如下图。

![](https://pic4.zhimg.com/80/v2-3b82ae9d6be32e234c8cf4089ef72093_1440w.jpg)

在基因组数据分析中，我们在不知道祖系状态的情况下，通常将MAF<0.05的位点舍弃，因为这可能是测序错误或者有害突变，并不一定代表基因的多态性。但是这也有可能包含了DAF>0.95的位点，也就是会丢失掉很多进化上很重要的位点。

如果我们知道了位点的祖系状态，那么还可以使用Fay and Wu's θ来描述位点多样性。

![](https://pic4.zhimg.com/80/v2-939413736a3c8b3d476fb4cf7440007f_1440w.jpg)

其中，Si表示有i个染色体含有S个derived位点。如计算上图中的θ可以是：

(\[1^2 \* 4\] + \[2^2 \* 1\] + \[3^2 \* 2\] + \[4^2 \* 1\] + \[8^2 \* 1\])/45 = 2.36

这也就是著名的**Fay and Wu's θ**。

### 三、有限位点模型中序列多样性的测量

之前不管是π还是θ，都是假设一个位点只有两种状态，即不存在一个位点存在多碱基突变的情况。这对一些物种（比如人）是没有问题的，因为群体中的三碱基突变很少，几乎没有四碱基突变。但是对于有些生物却不同，突变位点比分离位点要多，按照分离位点估计会造成对位点多样性的低估。其中对θ的影响要比对π的影响大的多。

Tajima（1996）在假设没有测序错误（测序错误会造成对位点多样性的高估）的前提下，使用Jukes-Cantor对θ的计算方法进行了校正，将多碱基突变的情况也考虑在多样性的计算公式中。校正之后的值比校正之前略有增大，这也就暗示着校正之前因为多碱基突变的情况存在，导致了对位点多样性的低估。

### 四、核酸多样性的解释

在假设没有选择的情况下，按照中性理论，一个群体中的核算多样性应该是

E(π) = θ = 4Neμ

也就是一个位点的多样性水平和这个群体的有效群体数量以及中性突变率成线性关系。但是实际上我们观察到的很多物种的多样性和有效群体数量仅存在很弱的相关性，这也就是**变异悖论**。很多物种的有效群体数量会相差好几个数量级，但是它们的核算多样性差异很小。相反的，人们却观察到**重组率和变异水平成正相关关系**！这是按照中心理论所没有预想到的。不过按照基因关联性理论（前面文章提到过），比如“背景选择”模型和“搭便车”模型，是可以预测出基因重组率增加会提高群体核算多样性的。“背景选择”理论认为一个群体中的有害突变的比例越少，该群体的核算多样性就会越多；“搭便车”理论认为随着重组率的增加，位点关联效应会降低，从而对该群体的核算多样性的影响也降低，使得核算多样性接近于中心理论的估计。

理论上θ = 4Neμ，但实际中很多统计量，π, θ(W), θ(H), η1, or ξ1并不等于4Neμ。不过通过上面的分析可以看出我们可以通过核算多样性来反求Ne，这也就提供了估计Ne的一种方法。Ne的大小和实际种群数量并不是一回事，Ne只是一个在遗传中常使用到的“虚构”的一个量。虽然Ne经常用到，但是这并不意味着实际种群数量不重要。相反，实际种群数量对进入群体中突变的数量影响很大，对种群的进化也有着很重要的影响。

### 五、多样性的其他描述

1. 微卫星变异
2. 单倍体变异


## 5